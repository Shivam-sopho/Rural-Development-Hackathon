<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Book Time</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

        <script type="text/javascript">

        	function getDate(){
        		var parameters = {};
        		parameters.nodalCenter = document.getElementById("nodalCenter").value;
        		console.log(parameters);
        		$.post('/getDate',parameters,function(data){
        			var arr = [];
        			for(var i=0;i<data.length;i++){

        				arr.push(data[i].date);
        			}
        			arr = Array.from(new Set(arr));
        			$("#date").html("")
        			$("#date").append("<option value='"+'Select Date'+"'>" + 'Select Date' + "</option>")
        			for(var i=0;i<arr.length;i++){
        				$("#date").append("<option value='"+arr[i]+"'>" + arr[i] + "</option>")
        			}
				})
        	}



        	function getTime(){
        		var parameters = {};
        		parameters.date = document.getElementById("date").value;
        		console.log(parameters);
        		$.post('/getTime',parameters,function(data){

        			var arr = [];
        			for(var i=0;i<data.length;i++){

        				arr.push(data[i].time);
        			}
        			arr = Array.from(new Set(arr));
        			console.log(arr)
        			$("#time").html("")
        			$("#time").append("<option value='"+'Select Time'+"'>" + 'Select Time' + "</option>")
        			for(var i=0;i<arr.length;i++){
        				$("#time").append("<option value='"+arr[i]+"'>" + arr[i] + "</option>")
        			}
				})
        	}
        </script>
    </head>
    <body>

    		<% var array = [] %>
    		<% for(var i=0;i<nodalCenter.length;i++) { %>
    			<% array.push(nodalCenter[i].nodalCenter) %>
    		<% } %>
    		<% array = Array.from(new Set(array)) %>


        <div class="container">
			<header>
				<h1><strong>Booking Time</strong></h1>
			</header>
			
			<section class="main">
				<form class="form-2" action="/bookedTime" method="post">
					<select onchange="getDate()" id="nodalCenter" name="nodalCenter">
						<option value="<%= 'Select Center'%>"><%='Select Center'%></option>
  				<% for(var i=0;i<array.length;i++) {%>
  					<option value="<%= array[i] %>"><%= array[i] %></option>
  				<% } %>
			</select>

			<select onchange="getTime()" id="date" name="date">
				
			</select>

			<select id="time" name="time">
				
			</select>
					<h1><span class="log-in">Book</span></h1>
					<p class="float">
						<label for="nodalCenter">Name</label>
						<input type="text" name="userName" placeholder="Name">
					</p>
					<br>
					<p class="float">
						<label for="date">Email Id</label>
						<input type="text" name="email" placeholder="Email">
					</p>
					<br>
					<p class="float">
						<label for="time">Phone</label>
						<input type="text" name="phone" placeholder="Phone">
					</p>
					<br>
					<p class="clearfix">     
						<input type="submit" name="submit" value="Book">
					</p>
				</form>​​
			</section>
        </div>
    </body>
</html>